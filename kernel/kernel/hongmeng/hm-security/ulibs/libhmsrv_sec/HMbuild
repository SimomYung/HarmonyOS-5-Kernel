# Copyright (c) Huawei Technologies Co., Ltd. 2021-2022. All rights reserved.
# Description: HMbuild for libhmsrv_sec
# Author: Huawei OS Kernel Lab
# Create: Tue Nov 09 10:25:23 2021

findpkg: HMLibC
findpkg: HMAuditLib
findpkg-CONFIG_SECCOMP: HMCbpfLib

subdir-y: libpolicy
subdir-y: librequester
subdir-y: libsec
subdir-y: libhmseccomp
subdir-y: libsecconf
subdir-y: libshlist
subdir-y: libcred
subdir-y: libhmencaps
subdir-y: libhmdec
subdir-CONFIG_HKIP_PRMEM: libhmkip
subdir-CONFIG_HKIP: libroafterinit

include-y: ../../include
inclib: HMUlibs::HMUlibs_sysif_sysmgr_include

# libhmsrv_sec.a
lib-static-y: hmsrv_sec
cflags-hmsrv_sec-CONFIG_PIE: -fPIE
cflags-.-CONFIG_AARCH64: -mgeneral-regs-only
install-hmsrv_sec-y: LIBDIR

# libhmsrv_sec.so
lib-dynamic-y: hmsrv_sec_shared
cflags-.-CONFIG_AARCH64: -mgeneral-regs-only
linklib-hmsrv_sec_shared-CONFIG_HKIP: -Taarch64-euler-elf-gcc.shared.ro_after_init.lds
linklib-hmsrv_sec_shared-y: HMLibC::HMUserLibC_shared
linklib-hmsrv_sec_shared-CONFIG_AUDIT: HMAuditLib::HMAuditLib_shared
linklib-hmsrv_sec_shared-CONFIG_SECCOMP: HMCbpfLib::HMCbpfLib_static
output-hmsrv_sec_shared: hmsrv_sec
install-hmsrv_sec_shared-y: LIBDIR

# vim:ts=4:sw=4:expandtab
