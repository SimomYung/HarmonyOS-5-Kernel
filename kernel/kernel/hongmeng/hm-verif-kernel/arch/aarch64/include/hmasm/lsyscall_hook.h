/*
 * Copyright (c) Huawei Technologies Co., Ltd. 2023-2023. All rights reserved.
 * Description: Declaration of syscall private hook in aarch64
 * Author: Huawei OS Kernel Lab
 * Create: Wed Apr 19 17:26:24 2023
 */

#ifndef ASM_EXTENSIONS_LSYSCALL_HOOK_H
#define ASM_EXTENSIONS_LSYSCALL_HOOK_H

#if !defined(DECLARE_LSYSCALL_NATIVE_HOOK)
#error "declare macro is not defined!"
#endif

#ifdef CONFIG_COMPAT
#if !defined(DECLARE_LSYSCALL_COMPAT_HOOK)
#error "declare macro is not defined!"
#endif
#endif

#ifdef __HOST_LLT__
#define LSCNO_OFFSET 460
#define TEST_DEMO_1_LCALLNO (15 + LSCNO_OFFSET)
#define TEST_DEMO_2_LCALLNO (16 + LSCNO_OFFSET)

DECLARE_LSYSCALL_NATIVE_HOOK(demo1, TEST_DEMO_1_LCALLNO)
DECLARE_LSYSCALL_NATIVE_HOOK(demo2, TEST_DEMO_2_LCALLNO)

#ifdef CONFIG_COMPAT
DECLARE_LSYSCALL_COMPAT_HOOK(demo1, TEST_DEMO_1_LCALLNO)
DECLARE_LSYSCALL_COMPAT_HOOK(demo2, TEST_DEMO_2_LCALLNO)
#endif
#endif

/* time related lsyscall */
DECLARE_LSYSCALL_NATIVE_HOOK(clock_gettime, ____NR_clock_gettime)

/* timerfd related lsyscall */
DECLARE_LSYSCALL_NATIVE_HOOK(futex, ____NR_futex)
DECLARE_LSYSCALL_NATIVE_HOOK(timerfd_create, ____NR_timerfd_create)
DECLARE_LSYSCALL_NATIVE_HOOK(timerfd_settime, ____NR_timerfd_settime)
DECLARE_LSYSCALL_NATIVE_HOOK(timerfd_gettime, ____NR_timerfd_gettime)
DECLARE_LSYSCALL_NATIVE_HOOK(getpid, ____NR_getpid)
DECLARE_LSYSCALL_NATIVE_HOOK(gettid, ____NR_gettid)
DECLARE_LSYSCALL_NATIVE_HOOK(prctl, ____NR_prctl)
DECLARE_LSYSCALL_NATIVE_HOOK(fsync, ____NR_fsync)
DECLARE_LSYSCALL_NATIVE_HOOK(syncfs, ____NR_syncfs)
DECLARE_LSYSCALL_NATIVE_HOOK(fdatasync, ____NR_fdatasync)
DECLARE_LSYSCALL_NATIVE_HOOK(sync_file_range, ____NR_sync_file_range)
DECLARE_LSYSCALL_NATIVE_HOOK(pread64, ____NR_pread64)
DECLARE_LSYSCALL_NATIVE_HOOK(pwrite64, ____NR_pwrite64)
DECLARE_LSYSCALL_NATIVE_HOOK(preadv, ____NR_preadv)
DECLARE_LSYSCALL_NATIVE_HOOK(preadv2, ____NR_preadv2)
DECLARE_LSYSCALL_NATIVE_HOOK(pwritev, ____NR_pwritev)
DECLARE_LSYSCALL_NATIVE_HOOK(pwritev2, ____NR_pwritev2)
DECLARE_LSYSCALL_NATIVE_HOOK(readv, ____NR_readv)
DECLARE_LSYSCALL_NATIVE_HOOK(lseek, ____NR_lseek)
DECLARE_LSYSCALL_NATIVE_HOOK(read, ____NR_read)
DECLARE_LSYSCALL_NATIVE_HOOK(write, ____NR_write)
DECLARE_LSYSCALL_NATIVE_HOOK(dup, ____NR_dup)
DECLARE_LSYSCALL_NATIVE_HOOK(dup3, ____NR_dup3)
DECLARE_LSYSCALL_NATIVE_HOOK(fcntl, ____NR_fcntl)
DECLARE_LSYSCALL_NATIVE_HOOK(getsockname, ____NR_getsockname)
DECLARE_LSYSCALL_NATIVE_HOOK(getpeername, ____NR_getpeername)
DECLARE_LSYSCALL_NATIVE_HOOK(writev, ____NR_writev)
DECLARE_LSYSCALL_NATIVE_HOOK(close, ____NR_close)
DECLARE_LSYSCALL_NATIVE_HOOK(getsockopt, ____NR_getsockopt)
DECLARE_LSYSCALL_NATIVE_HOOK(recvfrom, ____NR_recvfrom)
DECLARE_LSYSCALL_NATIVE_HOOK(sendmmsg, ____NR_sendmmsg)
DECLARE_LSYSCALL_NATIVE_HOOK(sendto, ____NR_sendto)
DECLARE_LSYSCALL_NATIVE_HOOK(sendmsg, ____NR_sendmsg)
DECLARE_LSYSCALL_NATIVE_HOOK(recvmsg, ____NR_recvmsg)
DECLARE_LSYSCALL_NATIVE_HOOK(recvmmsg, ____NR_recvmmsg)
DECLARE_LSYSCALL_NATIVE_HOOK(accept, ____NR_accept)
DECLARE_LSYSCALL_NATIVE_HOOK(accept4, ____NR_accept4)
DECLARE_LSYSCALL_NATIVE_HOOK(socket, ____NR_socket)
DECLARE_LSYSCALL_NATIVE_HOOK(socketpair, ____NR_socketpair)
DECLARE_LSYSCALL_NATIVE_HOOK(listen, ____NR_listen)
DECLARE_LSYSCALL_NATIVE_HOOK(bind, ____NR_bind)
DECLARE_LSYSCALL_NATIVE_HOOK(ioctl, ____NR_ioctl)
DECLARE_LSYSCALL_NATIVE_HOOK(connect, ____NR_connect)
DECLARE_LSYSCALL_NATIVE_HOOK(fchown, ____NR_fchown)
DECLARE_LSYSCALL_NATIVE_HOOK(setsockopt, ____NR_setsockopt)
DECLARE_LSYSCALL_NATIVE_HOOK(shutdown, ____NR_shutdown)
DECLARE_LSYSCALL_NATIVE_HOOK(epoll_ctl, ____NR_epoll_ctl)
DECLARE_LSYSCALL_NATIVE_HOOK(fstat, ____NR_fstat)
DECLARE_LSYSCALL_NATIVE_HOOK(fs_stat, ____NR_statx)
DECLARE_LSYSCALL_NATIVE_HOOK(fs_stat, ____NR_newfstatat)
DECLARE_LSYSCALL_NATIVE_HOOK(fs_stat, ____NR_faccessat)
DECLARE_LSYSCALL_NATIVE_HOOK(inotify_add_watch, ____NR_inotify_add_watch)
DECLARE_LSYSCALL_NATIVE_HOOK(inotify_rm_watch, ____NR_inotify_rm_watch)
DECLARE_LSYSCALL_NATIVE_HOOK(fchmod, ____NR_fchmod)
DECLARE_LSYSCALL_NATIVE_HOOK(flock, ____NR_flock)
DECLARE_LSYSCALL_NATIVE_HOOK(fchdir, ____NR_fchdir)
DECLARE_LSYSCALL_NATIVE_HOOK(fgetxattr, ____NR_fgetxattr)
DECLARE_LSYSCALL_NATIVE_HOOK(fsetxattr, ____NR_fsetxattr)
DECLARE_LSYSCALL_NATIVE_HOOK(flistxattr, ____NR_flistxattr)
DECLARE_LSYSCALL_NATIVE_HOOK(fremovexattr, ____NR_fremovexattr)
DECLARE_LSYSCALL_NATIVE_HOOK(readahead, ____NR_readahead)
DECLARE_LSYSCALL_NATIVE_HOOK(ftruncate, ____NR_ftruncate)
DECLARE_LSYSCALL_NATIVE_HOOK(fadvise, ____NR_fadvise64)
DECLARE_LSYSCALL_NATIVE_HOOK(fallocate, ____NR_fallocate)
DECLARE_LSYSCALL_NATIVE_HOOK(io_uring_enter, ____NR_io_uring_enter)
DECLARE_LSYSCALL_NATIVE_HOOK(io_uring_register, ____NR_io_uring_register)
DECLARE_LSYSCALL_NATIVE_HOOK(fs_no_xfer_common, ____NR_readlinkat)
DECLARE_LSYSCALL_NATIVE_HOOK(bpf, ____NR_bpf)
DECLARE_LSYSCALL_NATIVE_HOOK(openat, ____NR_openat)
DECLARE_LSYSCALL_NATIVE_HOOK(open_by_handle_at, ____NR_open_by_handle_at)
DECLARE_LSYSCALL_NATIVE_HOOK(pidfd_send_signal, ____NR_pidfd_send_signal)
DECLARE_LSYSCALL_NATIVE_HOOK(getuid, ____NR_getuid)
DECLARE_LSYSCALL_NATIVE_HOOK(rt_sigsuspend, ____NR_rt_sigsuspend)
DECLARE_LSYSCALL_NATIVE_HOOK(rt_sigtimedwait, ____NR_rt_sigtimedwait)
DECLARE_LSYSCALL_NATIVE_HOOK(execve, ____NR_execve)
DECLARE_LSYSCALL_NATIVE_HOOK(set_tid_address, ____NR_set_tid_address)
DECLARE_LSYSCALL_NATIVE_HOOK(nanosleep, ____NR_nanosleep)
DECLARE_LSYSCALL_NATIVE_HOOK(sched_yield, ____NR_sched_yield)
DECLARE_LSYSCALL_NATIVE_HOOK(epoll_pwait, ____NR_epoll_pwait)
DECLARE_LSYSCALL_NATIVE_HOOK(clone, ____NR_clone)
DECLARE_LSYSCALL_NATIVE_HOOK(munmap, ____NR_munmap)

#ifdef CONFIG_COMPAT
DECLARE_LSYSCALL_COMPAT_HOOK(rt_sigsuspend, ____NR_rt_sigsuspend_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(rt_sigtimedwait, ____NR_rt_sigtimedwait_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(execve, ____NR_execve_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(set_tid_address, ____NR_set_tid_address_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(nanosleep, ____NR_nanosleep_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(sched_yield, ____NR_sched_yield_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(epoll_pwait, ____NR_epoll_pwait_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(clone, ____NR_clone_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(munmap, ____NR_munmap_compat)

DECLARE_LSYSCALL_COMPAT_HOOK(futex, ____NR_futex_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(getpid, ____NR_getpid_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(gettid, ____NR_gettid_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(prctl, ____NR_prctl_compat)

/* time related lsyscall */
DECLARE_LSYSCALL_COMPAT_HOOK(clock_gettime32, ____NR_clock_gettime32_compat)

/* timerfd related lsyscall */
DECLARE_LSYSCALL_COMPAT_HOOK(timerfd_create, ____NR_timerfd_create_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(timerfd_settime, ____NR_timerfd_settime_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(timerfd_gettime, ____NR_timerfd_gettime_compat)

DECLARE_LSYSCALL_COMPAT_HOOK(fsync, ____NR_fsync_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(syncfs, ____NR_syncfs_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fdatasync, ____NR_fdatasync_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(sync_file_range2, ____NR_sync_file_range2_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(pread64, ____NR_pread64_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(pwrite64, ____NR_pwrite64_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(preadv, ____NR_preadv_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(preadv2, ____NR_preadv2_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(pwritev, ____NR_pwritev_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(pwritev2, ____NR_pwritev2_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(readv, ____NR_readv_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(lseek, ____NR_lseek_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(_llseek, ____NR__llseek_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(read, ____NR_read_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(write, ____NR_write_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(ioctl, ____NR_ioctl_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(dup, ____NR_dup_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(dup2, ____NR_dup2_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(dup3, ____NR_dup3_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fcntl, ____NR_fcntl_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fcntl, ____NR_fcntl64_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(recv, ____NR_recv_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(getsockname, ____NR_getsockname_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(getpeername, ____NR_getpeername_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(writev, ____NR_writev_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(close, ____NR_close_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(getsockopt, ____NR_getsockopt_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(recvfrom, ____NR_recvfrom_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(sendmmsg, ____NR_sendmmsg_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(send, ____NR_send_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(sendto, ____NR_sendto_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(sendmsg, ____NR_sendmsg_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(recvmsg, ____NR_recvmsg_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(recvmmsg, ____NR_recvmmsg_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(accept, ____NR_accept_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(accept4, ____NR_accept4_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(socket, ____NR_socket_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(socketpair, ____NR_socketpair_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(listen, ____NR_listen_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(bind, ____NR_bind_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(connect, ____NR_connect_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fchown, ____NR_fchown_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fchown, ____NR_fchown32_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(setsockopt, ____NR_setsockopt_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(shutdown, ____NR_shutdown_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(epoll_ctl, ____NR_epoll_ctl_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fstat, ____NR_fstat_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fstat, ____NR_fstat64_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fs_stat, ____NR_statx_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fs_stat, ____NR_fstatat64_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fs_stat, ____NR_faccessat_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(inotify_add_watch, ____NR_inotify_add_watch_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(inotify_rm_watch, ____NR_inotify_rm_watch_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fchmod, ____NR_fchmod_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(flock, ____NR_flock_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fchdir, ____NR_fchdir_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fgetxattr, ____NR_fgetxattr_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fsetxattr, ____NR_fsetxattr_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(flistxattr, ____NR_flistxattr_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fremovexattr, ____NR_fremovexattr_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(readahead, ____NR_readahead_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(ftruncate, ____NR_ftruncate_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(ftruncate, ____NR_ftruncate64_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fadvise, ____NR_fadvise64_64_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fallocate, ____NR_fallocate_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(io_uring_enter, ____NR_io_uring_enter_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(io_uring_register, ____NR_io_uring_register_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(fs_no_xfer_common, ____NR_readlinkat_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(bpf, ____NR_bpf_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(openat, ____NR_openat_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(open_by_handle_at, ____NR_open_by_handle_at_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(pidfd_send_signal, ____NR_pidfd_send_signal_compat)
DECLARE_LSYSCALL_COMPAT_HOOK(getuid, ____NR_getuid32_compat)
#endif /* CONFIG_COMPAT */
#undef ASM_EXTENSIONS_LSYSCALL_HOOK_H
#endif
